pipeline {
    agent none
    tools{
        jdk 'myjava'
        maven 'mymaven'
    }
     
        stages {
        stage('compile') {
              agent {label 'slave2'}
            steps {
                script{
                    echo "compile the code"
                    sh "mvn compile"
                }
                }
        }    
          stage('UnitTest') {    
           
              agent any
            steps {
                script{
                    echo "Running the test cases"
                    sh "mvn test"
                }
            }
        post{
            always{
                junit 'target/surefire-reports/*.xml'
            }
        }
        }


            stage('package') {                    
              agent any    
             steps {
                script{
                    sshagent(['ssh-key']) {
                    
                    echo "package the code"
                    sh "ssh -o StrictHostKeyChecking=no 'bash mvn package'"
                    
                }
                }
                }
                
            }

            
            }
        

